on:
  push:
      branches:
          - master
  pull_request:
      branches:
          - master

name: macOS build
jobs:
  test-macOS:
      runs-on: ${{ matrix.os }}
      name: ${{ matrix.os }} (${{ matrix.python-version}})
      strategy:
          fail-fast: false
          matrix:
            os: ["macOS-latest"]
            python-version: ["3.9"]
      steps:
          - uses: conda-incubator/setup-miniconda@v2
            with:
              auto-update-conda: true
              python-version: ${{ matrix.python-version }}
          - name: Install GDAL
            run: |
                python -m pip install --upgrade pip
                pip install --no-cache-dir Cython
                pip install --find-links=https://girder.github.io/large_image_wheels --no-cache GDAL
          - name: Test GDAL installation
            run: |
                python -c "from osgeo import gdal"
                gdalinfo --version
          - name: Install dependencies
            run: |
                pip install -r requirements.txt
                pip install .